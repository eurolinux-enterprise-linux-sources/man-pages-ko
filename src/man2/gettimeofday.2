.\" Hey Emacs! This file is -*- nroff -*- source.
.\"
.\" Copyright (c) 1992 Drew Eckhardt (drew@cs.colorado.edu), March 28, 1992
.\"
.\" Permission is granted to make and distribute verbatim copies of this
.\" manual provided the copyright notice and this permission notice are
.\" preserved on all copies.
.\"
.\" Permission is granted to copy and distribute modified versions of this
.\" manual under the conditions for verbatim copying, provided that the
.\" entire resulting derived work is distributed under the terms of a
.\" permission notice identical to this one
.\" 
.\" Since the Linux kernel and libraries are constantly changing, this
.\" manual page may be incorrect or out-of-date.  The author(s) assume no
.\" responsibility for errors or omissions, or for damages resulting from
.\" the use of the information contained herein.  The author(s) may not
.\" have taken the same level of care in the production of this manual,
.\" which is licensed free of charge, as they might when working
.\" professionally.
.\" 
.\" Formatted or processed versions of this manual, if unaccompanied by
.\" the source, must acknowledge the copyright and authors of this work.
.\"
.\" Modified by Michael Haardt (michael@moria.de)
.\" Modified Fri Jul 23 21:26:27 1993 by Rik Faith (faith@cs.unc.edu)
.\" Modified 21 Aug 1994 by Michael Chastain (mec@shell.portal.com):
.\"   Fixed necessary '#include' lines.
.\" Modified 15 Apr 1995 by Michael Chastain (mec@shell.portal.com):
.\"   Added reference to adjtimex.
.\" Removed some nonsense lines pointed out by Urs Thuermann,
.\"   (urs@isnogud.escape.de), aeb, 950722.
.\" Modified 14 Jan 1997 by Austin Donnelly (and1000@debian.org):
.\"   Added return values section, and bit on EFAULT
.\" Added clarification on timezone, aeb, 971210.
.\"
.TH GETTIMEOFDAY 2 "1997년 12월 10일" "리눅스 2.0.32" "리눅스 프로그래머 메뉴얼"
.SH 이름
gettimeofday, settimeofday \- 시간을 알아내거나 설정한다.
.SH 사용법
.B #include <sys/time.h>
.br
.B #include <unistd.h>
.sp
.BI "int gettimeofday(struct timeval *" tv ", struct timezone *" tz );
.br
.BI "int settimeofday(const struct timeval *" tv
.BI ", const struct timezone *" tz );
.SH 설명
.BR gettimeofday 와
.BR settimeofday 는 
시간대(timezone)과 시간을 설정할 수 있다.
.IR tv 는 
/usr/include/sys/time.h에 정의되어 있는 
.B timeval 
구조체이다:
.sp
.nf
struct timeval {
.in +8
long	tv_sec;     /* 초 */
long	tv_usec;    /* 마이크로초 */
.in -8
};
.fi
.PP
.sp
.IR tz 는 
.BR timezone 이다
:
.sp
.nf
struct timezone {
.in +8
int	tz_minuteswest; /* 그리니치 서측 분차(minutes) */
int	tz_dsttime;     /* DST 보정 타입 */
.in -8
};
.fi
.PP
timezone struct 는 사용하지 않는다; 리눅스에서 
.I tz_dsttime
필드가 사용되지 않는다. - 지금까지 그렇고 앞으로도 libc나 glibc에서 
지원되지 않을 것이다.
커널 소스에서(선언 이외에) 이 필드가 나오는 모든 경우는 버그이다.
그래서 다음 내용은 순수히 역사적인 흥미거리다.

.I tz_dsttime
필드는 Daylight Saving Time(일광 절약 시간) 년도에 강제로 지정되는 
상징적인 상수값(아래에 있는 값들)을 갖는다.
(주의: 이 값은 그 해동안 일정하다. - DST 값은 강제로 지정되지 않으며, 
알고리즘에서 선택된다.)
Daylight Saving Time 알고리즘은 아래처럼 정의된다:
.PP
.ta 14
\fB DST_NONE\fP	/* dst 사용하지 않음 */
.br
\fB DST_USA\fP	/* USA 스타일 dst */
.br
\fB DST_AUST\fP	/* 오스트레일리아 스타일 dst */
.br
\fB DST_WET\fP	/* 서부 유럽 dst */
.br
\fB DST_MET\fP	/* 중부 유럽 dst */
.br
\fB DST_EET\fP	/* 동부 유럽 dst */
.br
\fB DST_CAN\fP	/* 캐나다 */
.br
\fB DST_GB\fP	/* 영국와 아일랜드 */
.br
\fB DST_RUM\fP	/* 루마니아 */
.br
\fB DST_TUR\fP	/* 터키 */
.br
\fB DST_AUSTALT\fP	/* 1986의 오스트레일리아 스타일 */
.PP
물론, 이것은 Daylight Saving Time 기간이 나라마다 단순한 알고리즘으로 
강제로 주어질 수 없음을 말한다: 실제로, 이 기간은 정치적 이유로 결정된다.
그래서 시간대을 표현하는 이 방법은 버려졌다. 리눅스에서,
.B settimeofday
시스템 콜의
.I tz_dsttime
필드는 0이어야 한다.
.PP
리눅스에서는, 
.I tz
인자가 NULL이 아닌 경우나,
.I tv
인자가 NULL이고 
.I tz_minuteswest
필드가 0이 아닌 인자로 
.BR settimeofday 가
(부팅후) 처음 호출된다면 
특별한 `wrap clock` 의미가 있다.
그런 경우는 CMOS 시계는 로컬 시간이며, UTC 시스템 시간을 얻기 위한
시간만큼 증가했음을 말한다. 의심할 여지없이 이러한 특징을 사용하는 것은 
좋지 않다.
.PP
다음 매크로는 timeval 구조체 연산을 위해 정의된다:

.br
.nf
#define	timerisset(tvp)\\
.ti +8
((tvp)->tv_sec || (tvp)->tv_usec)
#define	timercmp(tvp, uvp, cmp)\\
.in +8
((tvp)->tv_sec cmp (uvp)->tv_sec ||\\
(tvp)->tv_sec == (uvp)->tv_sec &&\\
(tvp)->tv_usec cmp (uvp)->tv_usec)
.in -8
#define	timerclear(tvp)\\
.ti +8
((tvp)->tv_sec = (tvp)->tv_usec = 0)
.fi
.PP
만일,
.IR tv 나 
.IR tz 가 
null이라면, 관련 구조체는 설정되지 않거나 반환되지 않는다.
.PP
슈퍼유저만이 
.BR settimeofday 를 
사용할 수 있다.
.SH 반환값
.BR gettimeofday 와
.B settimeofday
모두 성공하면 0을 리턴하며, 실패시에는 -1을 리턴한다.
(\fIerrno\fP는 적당한 값으로 설정된다.)
.SH 에러
.TP
.B EPERM 
.BR settimeofday 가 
슈퍼유저이외의 다른 사용자에 의해 호출되었다.
.TP
.B EINVAL
시간대(또는 그외의 어떤 것)가 유효하지 않다.
.TP
.B EFAULT
.IR tv 나
.I tz
중 하나가 접근할 수 없는 영역을 가리키고 있다.
.SH 호환
SVr4, BSD 4.3
.SH 관련 항목
.BR date (1),
.BR adjtimex (2),
.BR time (2),
.BR ctime (3),
.BR ftime (3)
.SH 역자
정강훈 <skyeyes@soback.kornet.net>, 2000년 5월 1일
