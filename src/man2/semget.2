.\" Copyright 1993 Giorgio Ciucci (giorgio@crcc.it)
.\"
.\" Permission is granted to make and distribute verbatim copies of this
.\" manual provided the copyright notice and this permission notice are
.\" preserved on all copies.
.\"
.\" Permission is granted to copy and distribute modified versions of this
.\" manual under the conditions for verbatim copying, provided that the
.\" entire resulting derived work is distributed under the terms of a
.\" permission notice identical to this one
.\"
.\" Since the Linux kernel and libraries are constantly changing, this
.\" manual page may be incorrect or out-of-date.  The author(s) assume no
.\" responsibility for errors or omissions, or for damages resulting from
.\" the use of the information contained herein.  The author(s) may not
.\" have taken the same level of care in the production of this manual,
.\" which is licensed free of charge, as they might when working
.\" professionally.
.\"
.\" Formatted or processed versions of this manual, if unaccompanied by
.\" the source, must acknowledge the copyright and authors of this work.
.\"
.\" Modified Tue Oct 22 17:54:56 1996 by Eric S. Raymond <esr@thyrsus.com>
.\"
.\"
.\" 한국어 번역: ASPLINUX <man@asp-linux.co.kr> 2000년 7월 29일
.\"
.\" r1.4 2005-02-14 14:12:39 +24-26 윤현호
.\" r1.3 2004-08-10 21:32:58 +30-25 xaos
.\" r1.2 2004-08-10 20:46:19 +33-9 xaos
.\" r1.1 2004-08-10 20:31:54  xaos
.\"
.TH SEMGET 2 "November 1, 1993" "Linux 0.99.13" "Linux Programmer's Manual"
.SH 이름
semget \- 세마포어 집합 식별자를 얻어낸다.
.SH 사용법
.nf
.B
# include <sys/types.h>
.B
# include <sys/ipc.h>
.B
# include <sys/sem.h>
.fi
.sp
.BI "int semget ( key_t " key ,
.BI "int " nsems ,
.BI "int " semflg " )"
.SH 설명
이 함수는
.IR key
의 값에 대응하는 세마포어 집합 식별자를 반환한다.
.I key
의 값이
.B IPC_PRIVATE
일 경우, 또는
.I key
의 값이
.B IPC_PRIVATE
는 아니지만
.I key
에 대응하는 세마포어 집합이 없을 경우,
또는
.I semflg
이
.B IPC_CREAT
을 포함할 경우, 즉,
.I semflg
과
.B IPC_CREAT
의 AND연산이 0이 아닐 경우에
함수는 
.I nsems
개의 
세마포어를 갖는 새로운 집합을
만든다.
.I semflg
에
.B IPC_CREAT
와
.B IPC_EXCL
가 동시에 켜져 있는 것은,
.B open(2)
함수 의
mode 인수에
.B IPC_CREAT
와
.B IPC_EXCL
가 동시에 설정되어 있을 때와 동일한 역할을 한다.
즉, 
.I semflag
에
.B IPC_CREAT
와
.B IPC_EXCL
가 동시에 설정되어 있고,
.I key
에 해당하는 세마포어가 이미 존재할 때 함수는 실패한다.
.PP
세마포어 생성시, 인수
.I semflg
의 낮은 9비트는 세마포어 집합에 대한 접근 권한을 정의한다.
접근 권한의 형식은 
.B open
(2)
.B creat
(2) 시스템 호출의 접근권한 설정시와 동일하다. 
.\" 아래문장 확인바람.
단, 실행 허가는 시스템에 의해 주어지지 않으며, 세마포어 집합에 대한
쓰기권한은 실질적으론 변경권한을 의미한다.
.PP
게다가 생성시 시스템 호출은 시스템 세마포어 집합의 데이타 구조
.B semid_ds
를 다음과 같이 초기화한다:
.IP
.B sem_perm.cuid
와
.B sem_perm.uid
는 호출한 프로세스의 유효 사용자-ID로 설정된다.
.IP
.B sem_perm.cgid
와
.B sem_perm.gid
는 호출한 프로세스의 유효 그룹-ID로 설정된다.
.IP
.B sem_perm.mode
의 가장 낮은 9비트는
.IR semflg
의 가장 낮은 9비트로 설정된다.
.IP
.B sem_nsems
는
.IR nsems
의 값으로 설정된다.
.IP
.B sem_otime
는 0으로 설정된다.
.IP
.B sem_ctime
는 현재시각으로 설정된다.
.PP
인수
.I nsems
는 시스템호출이 집합을 생성하지 않을 경우에는
.B 0
일 수 있다.
그 외에
.I nsems
는
.B 0
보다 크고 semid당 세마포어의 최대값 이하인 수이어야만 한다.
.RB ( SEMMSL ).
.PP
.\" 아래문장 확인바람.
세마포어 집합이 이미 존재한다면, 접근 권한을 확인하고,
삭제될 것으로 표시되어있는지를 확인한다.
.SH 반환값
성공시, 반환값은 양의 정수값을 갖는 세마포어 집합 식별자일 것이고,
아니라면 에러를 나타내는
.B errno
와 함께
.B \-1
이 반환된다.
.SH 에러
실패값 반환을 위해,
.B errno
는 다음 값중 하나로 설정될 것이다:
.TP 11
.B EACCES
.IR key
에 대응하는 세마포어 집합이 존재하지만,
호출한 프로세스는 집합에 대한 접근권한이 없다.
.TP
.B EEXIST
.I semflg
에
.B IPC_CREAT
와
.BR IPC_EXCL
이 설정되어 있는데,
.IR key
에 대응하는 세마포어 집합이 이미 존재한다.
.TP
.B ENOENT
.I key
에 대응하는 세마포어 집합이 존재하지 않고,
.I semflg
에는
.BR IPC_CREAT
가 설정되어 있지도 않다.
.TP
.B ENOMEM
세마포어 집합이 생성되어야 하지만 시스템에 메모리가 부족하다.
.TP
.B ENOSPC
세마포어 집합이 생성되어야 하지만 시스템의
세마포어 집합 갯수 최대값,
.RB ( SEMMNI )
개별 세마포어 갯수의 최대값
.RB ( SEMMNS )
제한 때문에 만들지 못했다.
.SH 주의
.B IPC_PRIVATE
은 플래그가 아니고,
.B key_t
타입이다.
.IR key
가 이 값을 갖을 때에 시스템 호출은
.I semflg
의 아래 9비트 이외의 다른 것은 모두 무시하고
새로운 세마포어 집합을 생성한다.
.PP
다음은
.B semget
호출에 영향을 주는 세마포어 설정 자원을 제한한다:
.TP 11
.B SEMMNI
시스템 세마포어 설정의 최대값 범위: 정책의지.
.TP
.B SEMMSL
semid당 세마포어의 최대값: 구현 의지 (현재 500).
.TP
.B SEMMNS
시스템 세마포어의 최대값 범위; 정책 의지.
.SH 버그
.B IPC_PRIVATE
의 사용은 다른 할당된 세마포어 설정에 접근 프로세스들을 억제한다.
.PP
데이타 구조는 설정에 시스템 호출에 의해 초기화되지 않는 각 세마포어과 일치한다.
.SH 호환
SVr4, SVID.  SVr4 documents additional error conditions EINVAL, EFBIG,
E2BIG, EAGAIN, ERANGE, EFAULT.
.SH 관련 항목
.BR ftok (3),
.BR ipc (5),
.BR semctl (2),
.BR semop (2)
.SH 번역
ASPLINUX <man@asp-linux.co.kr> 2000년 7월 29일
.br
배성훈 <plodder@kldp.org> 2000년 11월 18일
.br
한글 Mnapage 프로젝트 (http://man.kldp.org) 2005년 2월 14일
