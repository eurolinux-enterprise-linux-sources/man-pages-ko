.\" Copyright (c) 1983, 1991 The Regents of the University of California.
.\" All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"	This product includes software developed by the University of
.\"	California, Berkeley and its contributors.
.\" 4. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"     $Id: listen.2,v 1.2 2002/07/28 07:10:25 hhyoon Exp $
.\"
.\" Modified Fri Jul 23 22:07:54 1993 by Rik Faith <faith@cs.unc.edu>
.\" Modified 950727 by aeb, following a suggestion by Urs Thuermann
.\" <urs@isnogud.escape.de>
.\" Modified Tue Oct 22 08:11:14 EDT 1996 by Eric S. Raymond <esr@thyrsus.com>
.\" Modified 1998 by Andi Kleen 
.\"
.TH LISTEN 2 "1993년 6월 23일" "BSD Man Page" "리눅스 프로그래머 매뉴얼"
.SH 이름
listen \- 소켓에서 연결들을 기다린다.
.SH 사용법
.B #include <sys/socket.h>
.sp
.BI "int listen(int " s ", int " backlog );
.SH 설명
연결을 받아들이기 위해, 소켓은 우선 들어오는 연결들을 받아들이기 위한
.BR socket (2)을
만들고, 들어오는 연결들에 대한 큐 제한 값을 
.BR listen 으로
명시하고, 그리고 연결들을 
.BR accept (2)으로
받아들인다.
.B listen
함수는 
.B SOCK_STREAM
이나
.BR SOCK_SEQPACKET
타입의 소켓들에만 적용된다.
.PP
.I backlog
인자는 아직 미결인 연결들에 대한 큐의 늘어날 수 있는 최대 길이를 정의한다.
큐에 도착한 연결 요청들이 꽉 찬다면 클라이언트는 
.B ECONNREFUSED
를 가리키는 에러를 받거나, 만일 하위 프로토콜이 재전송을 지원한다면,
요청은 재시도가 성공되도록 하기 위해 무시된다.
.SH 주의
TCP 소켓에서
.I backlog 
인자의 행위는 Linux 2.2에서 바뀌었다.
현재는 완결이 안된 연결 요청에 대한 큐 길이 대신에 accept가 되길
기다리는 연결이
.I 완전히
연결된 소켓들의 큐 길이를 지정한다
완결이 안된 소켓들에 대한 큐의 최대 길이는
.B tcp_max_syn_backlog
sysctl을 사용하여 설정할 수 있다.
syncookies가 활성화되어 있을 때는, 논리적인 최대 길이는 없게 되며
이 sysctl 설정은 무시된다. 더 많은 정보를 위해서
.BR tcp (7)를
참고하라.
.SH 반환값
성공시, 0이 리턴된다. 에러시, \-1이 리턴되며 
.I errno
는 적당한 값으로 설정된다.
.SH 에러
.TP
.B EADDRINUSE
다른 소켓이 이미 같은 포트를 listen하고 있다.
.TP
.B EBADF
인자
.I s
가 유효한 디스크립터가 아니다.
.TP
.B ENOTSOCK
인자
.I s
가 소켓이 아니다.
.TP
.B EOPNOTSUPP
소켓이 
.B listen 
작동을 지원하는 타입이 아니다.
.SH 호환
단일 Unix, 4.4BSD, POSIX 1003.1g 초안
.B listen
시스템 함수는 4.2BSD에서 처음 나타났다.
.SH 버그
만일 소켓이 
.BR AF_INET 타입이고
.I backlog
인자가
상수
.B SOMAXCONN 
보다 크다면(Linux 2.0 & 2.2에서 128), 그것은 예고없이
.BR SOMAXCONN 으로
짤려진다.
BSD(몇몇 BSD-기반 시스템)는 backlog를 5로 제한했으므로 호환성을 염두에 둔 
응용 프로그램에서는 이 값에 의존하지 마라.
.SH 관련 항목
.BR accept (2),
.BR connect (2),
.BR socket (2)
.SH 역자
이승식 <zican@freechal.com>, 2002년 6월 5일
.br
정강훈 <skyeyes@soback.kornet.net>, 2000년 7월 2일
